<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>src/f90/prog/ssht_test.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Types&nbsp;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_c7a17dbb9c7301c0cf24a41ffb6eb7fb.html">src</a>&nbsp;&raquo;&nbsp;<a class="el" href="dir_d8ecbefe5f4c5fc7165aeaa37f1b40b6.html">f90</a>&nbsp;&raquo;&nbsp;<a class="el" href="dir_1cc8a4d7e33e509ae1c3f8c327bb93e9.html">prog</a>
  </div>
</div>
<div class="contents">
<h1>ssht_test.f90</h1><a href="ssht__test_8f90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">! SSHT package to perform spin spherical harmonic transforms</span>
<a name="l00002"></a>00002 <span class="comment">! Copyright (C) 2011  Jason McEwen</span>
<a name="l00003"></a>00003 <span class="comment">! See LICENSE.txt for license details</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="comment">!------------------------------------------------------------------------------</span>
<a name="l00007"></a>00007 <span class="comment">! ssht_test</span>
<a name="l00008"></a>00008 <span class="comment">!</span>
<a name="l00021"></a>00021 
<a name="l00022"></a><a class="code" href="ssht__test_8f90.html#a2f7d152802f4b0b7c23f6ca1c2b2636b">00022</a> <span class="keyword">program</span> <a class="code" href="ssht__test_8f90.html#a2f7d152802f4b0b7c23f6ca1c2b2636b">ssht_test</a>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024   use <span class="keywordflow">ssht_types_mod</span>
<a name="l00025"></a>00025   use <span class="keywordflow">ssht_error_mod</span>
<a name="l00026"></a>00026   use <span class="keywordflow">ssht_sampling_mod</span>
<a name="l00027"></a>00027   use <span class="keywordflow">ssht_core_mod</span>
<a name="l00028"></a>00028 <span class="preprocessor">#ifdef NAGFOR</span>
<a name="l00029"></a>00029   use <span class="keywordflow">F90_UNIX_ENV</span>
<a name="l00030"></a>00030 <span class="preprocessor">#endif</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032   <span class="keyword">implicit none</span>
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="interfacessht__test____interface.html">00034</a>   <span class="keyword">interface</span>
<a name="l00035"></a><a class="code" href="interfacessht__test____interface.html#a606a77fc2140ecc86d8762f84aa4e8ba">00035</a>      <span class="keyword">subroutine </span><a class="code" href="ssht__test_8f90.html#a38f7ebbfee8c28f88b922ca179618a98">ssht_test_gen_flm_real</a>(L, flm, seed)
<a name="l00036"></a>00036        use <span class="keywordflow">ssht_types_mod</span>, only: dpc
<a name="l00037"></a>00037        <span class="keyword">implicit none</span>
<a name="l00038"></a>00038        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: L
<a name="l00039"></a>00039        <span class="keywordtype">complex(dpc)</span>, <span class="keywordtype">intent(out)</span> :: flm(0:L**2-1)
<a name="l00040"></a>00040        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: seed
<a name="l00041"></a>00041 <span class="keyword">     end subroutine ssht_test_gen_flm_real</span>
<a name="l00042"></a>00042 
<a name="l00043"></a><a class="code" href="interfacessht__test____interface.html#ad79d8a5e7fcd04d45e6b869709af2302">00043</a>      <span class="keyword">subroutine </span><a class="code" href="ssht__test_8f90.html#a7a26f08f722eb32bf1e26e298f083fac">ssht_test_gen_flm_complex</a>(L, spin, flm, seed)
<a name="l00044"></a>00044        use <span class="keywordflow">ssht_types_mod</span>, only: dpc
<a name="l00045"></a>00045        <span class="keyword">implicit none</span>
<a name="l00046"></a>00046        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: L
<a name="l00047"></a>00047        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: spin
<a name="l00048"></a>00048        <span class="keywordtype">complex(dpc)</span>, <span class="keywordtype">intent(out)</span> :: flm(0:L**2-1)
<a name="l00049"></a>00049        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: seed
<a name="l00050"></a>00050 <span class="keyword">     end subroutine ssht_test_gen_flm_complex</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="keyword">  end interface</span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054   <span class="keywordtype">character(len=64) </span>:: arg
<a name="l00055"></a>00055   <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: N_repeat = 3
<a name="l00056"></a>00056   <span class="keywordtype">integer</span> :: verbosity = 0
<a name="l00057"></a>00057   <span class="keywordtype">integer</span> :: fail = 0, seed, i_repeat
<a name="l00058"></a>00058   <span class="keywordtype">real</span> :: time_start, time_end
<a name="l00059"></a>00059 
<a name="l00060"></a>00060   <span class="keywordtype">real(dp) </span>:: errors_dh(0:N_repeat-1)
<a name="l00061"></a>00061   <span class="keywordtype">real</span> :: durations_forward_dh(0:N_repeat-1)
<a name="l00062"></a>00062   <span class="keywordtype">real</span> :: durations_inverse_dh(0:N_repeat-1)
<a name="l00063"></a>00063   <span class="keywordtype">real(dp) </span>:: errors_gl(0:N_repeat-1)
<a name="l00064"></a>00064   <span class="keywordtype">real</span> :: durations_forward_gl(0:N_repeat-1)
<a name="l00065"></a>00065   <span class="keywordtype">real</span> :: durations_inverse_gl(0:N_repeat-1)
<a name="l00066"></a>00066   <span class="keywordtype">real(dp) </span>:: errors_mweo(0:N_repeat-1)
<a name="l00067"></a>00067   <span class="keywordtype">real</span> :: durations_forward_mweo(0:N_repeat-1)
<a name="l00068"></a>00068   <span class="keywordtype">real</span> :: durations_inverse_mweo(0:N_repeat-1)
<a name="l00069"></a>00069   <span class="keywordtype">real(dp) </span>:: errors_mw(0:N_repeat-1)
<a name="l00070"></a>00070   <span class="keywordtype">real</span> :: durations_forward_mw(0:N_repeat-1)
<a name="l00071"></a>00071   <span class="keywordtype">real</span> :: durations_inverse_mw(0:N_repeat-1)
<a name="l00072"></a>00072 
<a name="l00073"></a>00073   <span class="keywordtype">real(dp) </span>:: errors_dh_real(0:N_repeat-1)
<a name="l00074"></a>00074   <span class="keywordtype">real</span> :: durations_forward_dh_real(0:N_repeat-1)
<a name="l00075"></a>00075   <span class="keywordtype">real</span> :: durations_inverse_dh_real(0:N_repeat-1)
<a name="l00076"></a>00076   <span class="keywordtype">real(dp) </span>:: errors_gl_real(0:N_repeat-1)
<a name="l00077"></a>00077   <span class="keywordtype">real</span> :: durations_forward_gl_real(0:N_repeat-1)
<a name="l00078"></a>00078   <span class="keywordtype">real</span> :: durations_inverse_gl_real(0:N_repeat-1)
<a name="l00079"></a>00079   <span class="keywordtype">real(dp) </span>:: errors_mweo_real(0:N_repeat-1)
<a name="l00080"></a>00080   <span class="keywordtype">real</span> :: durations_forward_mweo_real(0:N_repeat-1)
<a name="l00081"></a>00081   <span class="keywordtype">real</span> :: durations_inverse_mweo_real(0:N_repeat-1)
<a name="l00082"></a>00082   <span class="keywordtype">real(dp) </span>:: errors_mw_real(0:N_repeat-1)
<a name="l00083"></a>00083   <span class="keywordtype">real</span> :: durations_forward_mw_real(0:N_repeat-1)
<a name="l00084"></a>00084   <span class="keywordtype">real</span> :: durations_inverse_mw_real(0:N_repeat-1)
<a name="l00085"></a>00085 
<a name="l00086"></a>00086   <span class="keywordtype">integer</span> :: L, ind, ind_check, el, el_check, m, m_check
<a name="l00087"></a>00087   <span class="keywordtype">integer</span> :: spin
<a name="l00088"></a>00088   <span class="keywordtype">complex(dpc)</span>, <span class="keywordtype">allocatable</span> :: flm_orig(:), flm_syn(:)
<a name="l00089"></a>00089   <span class="keywordtype">complex(dpc)</span>, <span class="keywordtype">allocatable</span> :: f_dh(:,:), f_gl(:,:), f_mweo(:,:), f_mw(:,:)
<a name="l00090"></a>00090   <span class="keywordtype">real(dp)</span>, <span class="keywordtype">allocatable</span> :: f_dh_real(:,:), f_gl_real(:,:), f_mweo_real(:,:), f_mw_real(:,:)
<a name="l00091"></a>00091   <span class="keywordtype">real(dp) </span>:: phi_sp_mweo, phi_sp_mw
<a name="l00092"></a>00092   <span class="keywordtype">complex(dpc) </span>:: f_sp_mweo, f_sp_mw
<a name="l00093"></a>00093   <span class="keywordtype">real(dp) </span>:: f_real_sp_dh, f_real_sp_gl, f_real_sp_mweo, f_real_sp_mw
<a name="l00094"></a>00094 
<a name="l00095"></a>00095   <span class="comment">! Initialise parameters.</span>
<a name="l00096"></a>00096   call getarg(1, arg)
<a name="l00097"></a>00097   <span class="keyword">read</span>(arg,*) L
<a name="l00098"></a>00098   call getarg(2, arg)
<a name="l00099"></a>00099   <span class="keyword">read</span>(arg,*) spin
<a name="l00100"></a>00100   seed = 1
<a name="l00101"></a>00101 
<a name="l00102"></a>00102   <span class="comment">! Allocate memory.</span>
<a name="l00103"></a>00103   <span class="keyword">allocate</span>(flm_orig(0:L**2-1), stat=fail)
<a name="l00104"></a>00104   <span class="keyword">allocate</span>(flm_syn(0:L**2-1), stat=fail)  
<a name="l00105"></a>00105   <span class="keyword">allocate</span>(f_dh(0:2*L-1, 0:2*L-2), stat=fail)
<a name="l00106"></a>00106   <span class="keyword">allocate</span>(f_gl(0:L-1, 0:2*L-2), stat=fail)
<a name="l00107"></a>00107   <span class="keyword">allocate</span>(f_mweo(0:L-2, 0:2*L-2), stat=fail)
<a name="l00108"></a>00108   <span class="keyword">allocate</span>(f_mw(0:L-2, 0:2*L-2), stat=fail)
<a name="l00109"></a>00109   <span class="keyword">allocate</span>(f_dh_real(0:2*L-1, 0:2*L-2), stat=fail)
<a name="l00110"></a>00110   <span class="keyword">allocate</span>(f_gl_real(0:L-1, 0:2*L-2), stat=fail)
<a name="l00111"></a>00111   <span class="keyword">allocate</span>(f_mweo_real(0:L-2, 0:2*L-2), stat=fail)
<a name="l00112"></a>00112   <span class="keyword">allocate</span>(f_mw_real(0:L-2, 0:2*L-2), stat=fail)
<a name="l00113"></a>00113   <span class="keyword">if</span>(fail /= 0) <span class="keyword">then</span>
<a name="l00114"></a>00114      call <a class="code" href="namespacessht__error__mod.html#ab9c297719b0acfce921d32866ddc2b42">ssht_error</a>(<a class="code" href="namespacessht__error__mod.html#a063205e3aeaa862ea49f58294f0965b6">SSHT_ERROR_MEM_ALLOC_FAIL</a>, <span class="stringliteral">&#39;ssht_test&#39;</span>)
<a name="l00115"></a>00115   <span class="keyword">end if</span>
<a name="l00116"></a>00116   flm_orig(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00117"></a>00117   flm_syn(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00118"></a>00118   f_dh(0:2*L-1, 0:2*L-2) = cmplx(0d0, 0d0)
<a name="l00119"></a>00119   f_gl(0:L-1, 0:2*L-2) = cmplx(0d0, 0d0)
<a name="l00120"></a>00120   f_mweo(0:L-2, 0:2*L-2) = cmplx(0d0, 0d0)
<a name="l00121"></a>00121   f_mw(0:L-2, 0:2*L-2) = cmplx(0d0, 0d0)
<a name="l00122"></a>00122   f_dh_real(0:2*L-1, 0:2*L-2) = 0d0
<a name="l00123"></a>00123   f_gl_real(0:L-1, 0:2*L-2) = 0d0
<a name="l00124"></a>00124   f_mweo_real(0:L-2, 0:2*L-2) = 0d0
<a name="l00125"></a>00125   f_mw_real(0:L-2, 0:2*L-2) = 0d0
<a name="l00126"></a>00126 
<a name="l00127"></a>00127   <span class="comment">! Write program name.</span>
<a name="l00128"></a>00128   <span class="keyword">write</span>(*,*)
<a name="l00129"></a>00129   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;SSHT test program&#39;</span>
<a name="l00130"></a>00130   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;===============================================================&#39;</span>
<a name="l00131"></a>00131   <span class="keyword">write</span>(*,*)
<a name="l00132"></a>00132 
<a name="l00133"></a>00133   <span class="comment">! Test index conversion between (el,m) and ind.</span>
<a name="l00134"></a>00134   ind_check = 0
<a name="l00135"></a>00135   <span class="keyword">do</span> el = 0, L-1     
<a name="l00136"></a>00136      <span class="keyword">do</span> m = -el, el       
<a name="l00137"></a>00137         call <a class="code" href="namespacessht__sampling__mod.html#a6783e48e387b35bb4a2dc9d5bf575f34">ssht_sampling_elm2ind</a>(ind, el, m)
<a name="l00138"></a>00138         <span class="keyword">if</span> (ind /= ind_check) <span class="keyword">then</span>
<a name="l00139"></a>00139            call <a class="code" href="namespacessht__error__mod.html#ab9c297719b0acfce921d32866ddc2b42">ssht_error</a>(<a class="code" href="namespacessht__error__mod.html#a9e7da7d73d594698fbfcc1de092e0499">SSHT_ERROR_INDEX_INVALID</a>, <span class="stringliteral">&#39;ssht_test&#39;</span>)
<a name="l00140"></a>00140         <span class="keyword">end if</span>
<a name="l00141"></a>00141         call <a class="code" href="namespacessht__sampling__mod.html#a2d7fd96a0f07c68f8b7be0f3f45908a2">ssht_sampling_ind2elm</a>(el_check, m_check, ind)
<a name="l00142"></a>00142         <span class="keyword">if</span> (el /= el_check .and. m /= m_check) <span class="keyword">then</span>
<a name="l00143"></a>00143            call <a class="code" href="namespacessht__error__mod.html#ab9c297719b0acfce921d32866ddc2b42">ssht_error</a>(<a class="code" href="namespacessht__error__mod.html#a9e7da7d73d594698fbfcc1de092e0499">SSHT_ERROR_INDEX_INVALID</a>, <span class="stringliteral">&#39;ssht_test&#39;</span>)
<a name="l00144"></a>00144         <span class="keyword">end if</span>
<a name="l00145"></a>00145         ind_check = ind_check + 1
<a name="l00146"></a>00146      <span class="keyword">end do</span>
<a name="l00147"></a>00147   <span class="keyword">end do</span>
<a name="l00148"></a>00148   <span class="keyword">if</span> (ind_check /= L**2) <span class="keyword">then</span>
<a name="l00149"></a>00149      call <a class="code" href="namespacessht__error__mod.html#ab9c297719b0acfce921d32866ddc2b42">ssht_error</a>(<a class="code" href="namespacessht__error__mod.html#a9e7da7d73d594698fbfcc1de092e0499">SSHT_ERROR_INDEX_INVALID</a>, <span class="stringliteral">&#39;ssht_test&#39;</span>)
<a name="l00150"></a>00150   <span class="keyword">end if</span>
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="comment">! Run algorithm error and timing tests.</span>
<a name="l00153"></a>00153   <span class="keyword">do</span> i_repeat = 0,N_repeat-1
<a name="l00154"></a>00154 
<a name="l00155"></a>00155      <span class="comment">! If spin=0 run tests on algorithms optimised for real spin=0 signal.</span>
<a name="l00156"></a>00156      <span class="keyword">if</span> (spin == 0) <span class="keyword">then</span> 
<a name="l00157"></a>00157 
<a name="l00158"></a>00158         <span class="comment">!=========================================================================</span>
<a name="l00159"></a>00159         <span class="comment">! DH real spin=0</span>
<a name="l00160"></a>00160         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;DH real spin=0 test no.&#39;</span>, i_repeat
<a name="l00161"></a>00161         flm_orig(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00162"></a>00162         flm_syn(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00163"></a>00163         call <a class="code" href="ssht__test_8f90.html#a38f7ebbfee8c28f88b922ca179618a98">ssht_test_gen_flm_real</a>(L, flm_orig, seed)
<a name="l00164"></a>00164         call cpu_time(time_start)
<a name="l00165"></a>00165         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00166"></a>00166         call <a class="code" href="interfacessht__core__mod_1_1ssht__core__dh__inverse__real.html">ssht_core_dh_inverse_real</a>(f_dh_real, flm_orig, L, verbosity)
<a name="l00167"></a>00167         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00168"></a>00168         call cpu_time(time_end)
<a name="l00169"></a>00169         durations_inverse_dh_real(i_repeat) = time_end - time_start
<a name="l00170"></a>00170         call cpu_time(time_start)
<a name="l00171"></a>00171         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00172"></a>00172         call <a class="code" href="interfacessht__core__mod_1_1ssht__core__dh__forward__real.html">ssht_core_dh_forward_real</a>(flm_syn, f_dh_real, L, verbosity)
<a name="l00173"></a>00173         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00174"></a>00174         call cpu_time(time_end)
<a name="l00175"></a>00175         durations_forward_dh_real(i_repeat) = time_end - time_start
<a name="l00176"></a>00176         errors_dh_real(i_repeat) = maxval(abs(flm_orig(0:L**2-1) - flm_syn(0:L**2-1)))
<a name="l00177"></a>00177         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_inverse (s) =&#39;</span>, &amp;
<a name="l00178"></a>00178              durations_inverse_dh_real(i_repeat)
<a name="l00179"></a>00179         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_forward (s) =&#39;</span>, &amp;
<a name="l00180"></a>00180              durations_forward_dh_real(i_repeat)
<a name="l00181"></a>00181         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e40.5)&#39;</span>) <span class="stringliteral">&#39; error                =&#39;</span>, &amp;
<a name="l00182"></a>00182              errors_dh_real(i_repeat)
<a name="l00183"></a>00183         <span class="keyword">write</span>(*,*)
<a name="l00184"></a>00184 
<a name="l00185"></a>00185         <span class="comment">!=========================================================================</span>
<a name="l00186"></a>00186         <span class="comment">! GL real spin=0</span>
<a name="l00187"></a>00187         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;GL real spin=0 test no.&#39;</span>, i_repeat
<a name="l00188"></a>00188         flm_orig(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00189"></a>00189         flm_syn(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00190"></a>00190         call <a class="code" href="ssht__test_8f90.html#a38f7ebbfee8c28f88b922ca179618a98">ssht_test_gen_flm_real</a>(L, flm_orig, seed)
<a name="l00191"></a>00191         call cpu_time(time_start)
<a name="l00192"></a>00192         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00193"></a>00193         call <a class="code" href="interfacessht__core__mod_1_1ssht__core__gl__inverse__real.html">ssht_core_gl_inverse_real</a>(f_gl_real, flm_orig, L, verbosity)
<a name="l00194"></a>00194         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00195"></a>00195         call cpu_time(time_end)
<a name="l00196"></a>00196         durations_inverse_gl_real(i_repeat) = time_end - time_start
<a name="l00197"></a>00197         call cpu_time(time_start)
<a name="l00198"></a>00198         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00199"></a>00199         call <a class="code" href="interfacessht__core__mod_1_1ssht__core__gl__forward__real.html">ssht_core_gl_forward_real</a>(flm_syn, f_gl_real, L, verbosity)
<a name="l00200"></a>00200         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00201"></a>00201         call cpu_time(time_end)
<a name="l00202"></a>00202         durations_forward_gl_real(i_repeat) = time_end - time_start
<a name="l00203"></a>00203         errors_gl_real(i_repeat) = maxval(abs(flm_orig(0:L**2-1) - flm_syn(0:L**2-1)))
<a name="l00204"></a>00204         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_inverse (s) =&#39;</span>, &amp;
<a name="l00205"></a>00205              durations_inverse_gl_real(i_repeat)
<a name="l00206"></a>00206         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_forward (s) =&#39;</span>, &amp;
<a name="l00207"></a>00207              durations_forward_gl_real(i_repeat)
<a name="l00208"></a>00208         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e40.5)&#39;</span>) <span class="stringliteral">&#39; error                =&#39;</span>, &amp;
<a name="l00209"></a>00209              errors_gl_real(i_repeat)
<a name="l00210"></a>00210         <span class="keyword">write</span>(*,*)
<a name="l00211"></a>00211 
<a name="l00212"></a>00212         <span class="comment">!=========================================================================</span>
<a name="l00213"></a>00213         <span class="comment">! MWEO real spin=0</span>
<a name="l00214"></a>00214         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;MWEO real spin=0 test no.&#39;</span>, i_repeat
<a name="l00215"></a>00215         flm_orig(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00216"></a>00216         flm_syn(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00217"></a>00217         call <a class="code" href="ssht__test_8f90.html#a38f7ebbfee8c28f88b922ca179618a98">ssht_test_gen_flm_real</a>(L, flm_orig, seed)
<a name="l00218"></a>00218         call cpu_time(time_start)
<a name="l00219"></a>00219         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00220"></a>00220         call <a class="code" href="interfacessht__core__mod_1_1ssht__core__mweo__inverse__real.html">ssht_core_mweo_inverse_real</a>(f_mweo_real, &amp;
<a name="l00221"></a>00221              f_real_sp_mweo, flm_orig, L, verbosity)
<a name="l00222"></a>00222         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00223"></a>00223         call cpu_time(time_end)
<a name="l00224"></a>00224         durations_inverse_mweo_real(i_repeat) = time_end - time_start
<a name="l00225"></a>00225         call cpu_time(time_start)
<a name="l00226"></a>00226         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00227"></a>00227         call <a class="code" href="interfacessht__core__mod_1_1ssht__core__mweo__forward__real.html">ssht_core_mweo_forward_real</a>(flm_syn, &amp;
<a name="l00228"></a>00228              f_mweo_real, f_real_sp_mweo, L, verbosity)
<a name="l00229"></a>00229         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00230"></a>00230         call cpu_time(time_end)
<a name="l00231"></a>00231         durations_forward_mweo_real(i_repeat) = time_end - time_start
<a name="l00232"></a>00232         errors_mweo_real(i_repeat) = maxval(abs(flm_orig(0:L**2-1) - flm_syn(0:L**2-1)))
<a name="l00233"></a>00233         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_inverse (s) =&#39;</span>, &amp;
<a name="l00234"></a>00234              durations_inverse_mweo_real(i_repeat)
<a name="l00235"></a>00235         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_forward (s) =&#39;</span>, &amp;
<a name="l00236"></a>00236              durations_forward_mweo_real(i_repeat)
<a name="l00237"></a>00237         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e40.5)&#39;</span>) <span class="stringliteral">&#39; error                =&#39;</span>, &amp;
<a name="l00238"></a>00238              errors_mweo_real(i_repeat)
<a name="l00239"></a>00239         <span class="keyword">write</span>(*,*)
<a name="l00240"></a>00240 
<a name="l00241"></a>00241         <span class="comment">!=========================================================================</span>
<a name="l00242"></a>00242         <span class="comment">! MW real spin=0</span>
<a name="l00243"></a>00243         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;MW real spin=0 test no.&#39;</span>, i_repeat
<a name="l00244"></a>00244         flm_orig(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00245"></a>00245         flm_syn(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00246"></a>00246         call <a class="code" href="ssht__test_8f90.html#a38f7ebbfee8c28f88b922ca179618a98">ssht_test_gen_flm_real</a>(L, flm_orig, seed)
<a name="l00247"></a>00247         call cpu_time(time_start)
<a name="l00248"></a>00248         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00249"></a>00249         call <a class="code" href="interfacessht__core__mod_1_1ssht__core__mw__inverse__real.html">ssht_core_mw_inverse_real</a>(f_mw_real, &amp;
<a name="l00250"></a>00250              f_real_sp_mw, flm_orig, L, verbosity)
<a name="l00251"></a>00251         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00252"></a>00252         call cpu_time(time_end)
<a name="l00253"></a>00253         durations_inverse_mw_real(i_repeat) = time_end - time_start
<a name="l00254"></a>00254         call cpu_time(time_start)
<a name="l00255"></a>00255         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00256"></a>00256         call <a class="code" href="interfacessht__core__mod_1_1ssht__core__mw__forward__real.html">ssht_core_mw_forward_real</a>(flm_syn, &amp;
<a name="l00257"></a>00257              f_mw_real, f_real_sp_mw, L, verbosity)
<a name="l00258"></a>00258         <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00259"></a>00259         call cpu_time(time_end)
<a name="l00260"></a>00260         durations_forward_mw_real(i_repeat) = time_end - time_start
<a name="l00261"></a>00261         errors_mw_real(i_repeat) = maxval(abs(flm_orig(0:L**2-1) - flm_syn(0:L**2-1)))
<a name="l00262"></a>00262         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_inverse (s) =&#39;</span>, &amp;
<a name="l00263"></a>00263              durations_inverse_mw_real(i_repeat)
<a name="l00264"></a>00264         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_forward (s) =&#39;</span>, &amp;
<a name="l00265"></a>00265              durations_forward_mw_real(i_repeat)
<a name="l00266"></a>00266         <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e40.5)&#39;</span>) <span class="stringliteral">&#39; error                =&#39;</span>, &amp;
<a name="l00267"></a>00267              errors_mw_real(i_repeat)
<a name="l00268"></a>00268         <span class="keyword">write</span>(*,*)
<a name="l00269"></a>00269 
<a name="l00270"></a>00270      <span class="keyword">end if</span>
<a name="l00271"></a>00271 
<a name="l00272"></a>00272      <span class="comment">!=========================================================================</span>
<a name="l00273"></a>00273      <span class="comment">! DH</span>
<a name="l00274"></a>00274      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;DH test no.&#39;</span>, i_repeat
<a name="l00275"></a>00275      flm_orig(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00276"></a>00276      flm_syn(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00277"></a>00277      call <a class="code" href="ssht__test_8f90.html#a7a26f08f722eb32bf1e26e298f083fac">ssht_test_gen_flm_complex</a>(L, spin, flm_orig, seed)
<a name="l00278"></a>00278      call cpu_time(time_start)
<a name="l00279"></a>00279      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00280"></a>00280      call <a class="code" href="interfacessht__core__mod_1_1ssht__core__dh__inverse.html">ssht_core_dh_inverse</a>(f_dh, flm_orig, L, spin, verbosity)
<a name="l00281"></a>00281      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00282"></a>00282      call cpu_time(time_end)
<a name="l00283"></a>00283      durations_inverse_dh(i_repeat) = time_end - time_start
<a name="l00284"></a>00284      call cpu_time(time_start)
<a name="l00285"></a>00285      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00286"></a>00286      call <a class="code" href="interfacessht__core__mod_1_1ssht__core__dh__forward.html">ssht_core_dh_forward</a>(flm_syn, f_dh, L, spin, verbosity)
<a name="l00287"></a>00287      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00288"></a>00288      call cpu_time(time_end)
<a name="l00289"></a>00289      durations_forward_dh(i_repeat) = time_end - time_start
<a name="l00290"></a>00290      errors_dh(i_repeat) = maxval(abs(flm_orig(0:L**2-1) - flm_syn(0:L**2-1)))
<a name="l00291"></a>00291      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_inverse (s) =&#39;</span>, &amp;
<a name="l00292"></a>00292           durations_inverse_dh(i_repeat)
<a name="l00293"></a>00293      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_forward (s) =&#39;</span>, &amp;
<a name="l00294"></a>00294           durations_forward_dh(i_repeat)
<a name="l00295"></a>00295      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e40.5)&#39;</span>) <span class="stringliteral">&#39; error                =&#39;</span>, &amp;
<a name="l00296"></a>00296           errors_dh(i_repeat)
<a name="l00297"></a>00297      <span class="keyword">write</span>(*,*)
<a name="l00298"></a>00298 
<a name="l00299"></a>00299      <span class="comment">!=========================================================================</span>
<a name="l00300"></a>00300      <span class="comment">! GL</span>
<a name="l00301"></a>00301      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;GL test no.&#39;</span>, i_repeat
<a name="l00302"></a>00302      flm_orig(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00303"></a>00303      flm_syn(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00304"></a>00304      call <a class="code" href="ssht__test_8f90.html#a7a26f08f722eb32bf1e26e298f083fac">ssht_test_gen_flm_complex</a>(L, spin, flm_orig, seed)
<a name="l00305"></a>00305      call cpu_time(time_start)
<a name="l00306"></a>00306      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00307"></a>00307      call <a class="code" href="interfacessht__core__mod_1_1ssht__core__gl__inverse.html">ssht_core_gl_inverse</a>(f_gl, flm_orig, L, spin, verbosity)
<a name="l00308"></a>00308      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00309"></a>00309      call cpu_time(time_end)
<a name="l00310"></a>00310      durations_inverse_gl(i_repeat) = time_end - time_start
<a name="l00311"></a>00311      call cpu_time(time_start)
<a name="l00312"></a>00312      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00313"></a>00313      call <a class="code" href="interfacessht__core__mod_1_1ssht__core__gl__forward.html">ssht_core_gl_forward</a>(flm_syn, f_gl, L, spin, verbosity)
<a name="l00314"></a>00314      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00315"></a>00315      call cpu_time(time_end)
<a name="l00316"></a>00316      durations_forward_gl(i_repeat) = time_end - time_start
<a name="l00317"></a>00317      errors_gl(i_repeat) = maxval(abs(flm_orig(0:L**2-1) - flm_syn(0:L**2-1)))
<a name="l00318"></a>00318      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_inverse (s) =&#39;</span>, &amp;
<a name="l00319"></a>00319           durations_inverse_gl(i_repeat)
<a name="l00320"></a>00320      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_forward (s) =&#39;</span>, &amp;
<a name="l00321"></a>00321           durations_forward_gl(i_repeat)
<a name="l00322"></a>00322      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e40.5)&#39;</span>) <span class="stringliteral">&#39; error                =&#39;</span>, &amp;
<a name="l00323"></a>00323           errors_gl(i_repeat)
<a name="l00324"></a>00324      <span class="keyword">write</span>(*,*)
<a name="l00325"></a>00325 
<a name="l00326"></a>00326      <span class="comment">!=========================================================================</span>
<a name="l00327"></a>00327      <span class="comment">! MWEO</span>
<a name="l00328"></a>00328      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;MWEO test no.&#39;</span>, i_repeat
<a name="l00329"></a>00329      flm_orig(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00330"></a>00330      flm_syn(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00331"></a>00331      call <a class="code" href="ssht__test_8f90.html#a7a26f08f722eb32bf1e26e298f083fac">ssht_test_gen_flm_complex</a>(L, spin, flm_orig, seed)
<a name="l00332"></a>00332      call cpu_time(time_start)
<a name="l00333"></a>00333      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00334"></a>00334      call <a class="code" href="interfacessht__core__mod_1_1ssht__core__mweo__inverse.html">ssht_core_mweo_inverse</a>(f_mweo, f_sp_mweo, phi_sp_mweo, &amp;
<a name="l00335"></a>00335           flm_orig, L, spin, verbosity)
<a name="l00336"></a>00336      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00337"></a>00337      call cpu_time(time_end)
<a name="l00338"></a>00338      durations_inverse_mweo(i_repeat) = time_end - time_start
<a name="l00339"></a>00339      call cpu_time(time_start)
<a name="l00340"></a>00340      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00341"></a>00341      call <a class="code" href="interfacessht__core__mod_1_1ssht__core__mweo__forward.html">ssht_core_mweo_forward</a>(flm_syn, f_mweo, &amp;
<a name="l00342"></a>00342           f_sp_mweo, phi_sp_mweo, L, spin, verbosity)
<a name="l00343"></a>00343      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00344"></a>00344      call cpu_time(time_end)
<a name="l00345"></a>00345      durations_forward_mweo(i_repeat) = time_end - time_start
<a name="l00346"></a>00346      errors_mweo(i_repeat) = maxval(abs(flm_orig(0:L**2-1) - flm_syn(0:L**2-1)))
<a name="l00347"></a>00347      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_inverse (s) =&#39;</span>, &amp;
<a name="l00348"></a>00348           durations_inverse_mweo(i_repeat)
<a name="l00349"></a>00349      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_forward (s) =&#39;</span>, &amp;
<a name="l00350"></a>00350           durations_forward_mweo(i_repeat)
<a name="l00351"></a>00351      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e40.5)&#39;</span>) <span class="stringliteral">&#39; error                =&#39;</span>, &amp;
<a name="l00352"></a>00352           errors_mweo(i_repeat)
<a name="l00353"></a>00353      <span class="keyword">write</span>(*,*)
<a name="l00354"></a>00354 
<a name="l00355"></a>00355      <span class="comment">!=========================================================================</span>
<a name="l00356"></a>00356      <span class="comment">! MW</span>
<a name="l00357"></a>00357      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;MW test no.&#39;</span>, i_repeat
<a name="l00358"></a>00358      flm_orig(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00359"></a>00359      flm_syn(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00360"></a>00360      call <a class="code" href="ssht__test_8f90.html#a7a26f08f722eb32bf1e26e298f083fac">ssht_test_gen_flm_complex</a>(L, spin, flm_orig, seed)
<a name="l00361"></a>00361      call cpu_time(time_start)
<a name="l00362"></a>00362      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00363"></a>00363      call <a class="code" href="interfacessht__core__mod_1_1ssht__core__mw__inverse.html">ssht_core_mw_inverse</a>(f_mw, f_sp_mw, phi_sp_mw, &amp;
<a name="l00364"></a>00364           flm_orig, L, spin, verbosity)
<a name="l00365"></a>00365      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00366"></a>00366      call cpu_time(time_end)
<a name="l00367"></a>00367      durations_inverse_mw(i_repeat) = time_end - time_start
<a name="l00368"></a>00368      call cpu_time(time_start)
<a name="l00369"></a>00369      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00370"></a>00370      call <a class="code" href="interfacessht__core__mod_1_1ssht__core__mw__forward.html">ssht_core_mw_forward</a>(flm_syn, f_mw, &amp;
<a name="l00371"></a>00371           f_sp_mw, phi_sp_mw, L, spin, verbosity)
<a name="l00372"></a>00372      <span class="comment">!-------------------------------------------------------------------------</span>
<a name="l00373"></a>00373      call cpu_time(time_end)
<a name="l00374"></a>00374      durations_forward_mw(i_repeat) = time_end - time_start
<a name="l00375"></a>00375      errors_mw(i_repeat) = maxval(abs(flm_orig(0:L**2-1) - flm_syn(0:L**2-1)))
<a name="l00376"></a>00376      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_inverse (s) =&#39;</span>, &amp;
<a name="l00377"></a>00377           durations_inverse_mw(i_repeat)
<a name="l00378"></a>00378      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f40.4)&#39;</span>) <span class="stringliteral">&#39; duration_forward (s) =&#39;</span>, &amp;
<a name="l00379"></a>00379           durations_forward_mw(i_repeat)
<a name="l00380"></a>00380      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e40.5)&#39;</span>) <span class="stringliteral">&#39; error                =&#39;</span>, &amp;
<a name="l00381"></a>00381           errors_mw(i_repeat)
<a name="l00382"></a>00382      <span class="keyword">write</span>(*,*)
<a name="l00383"></a>00383 
<a name="l00384"></a>00384   <span class="keyword">end do</span>
<a name="l00385"></a>00385 
<a name="l00386"></a>00386   <span class="comment">! Print summary.</span>
<a name="l00387"></a>00387   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;===============================================================&#39;</span>
<a name="l00388"></a>00388   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Summary&#39;</span>
<a name="l00389"></a>00389   <span class="keyword">write</span>(*,*)
<a name="l00390"></a>00390   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i40)&#39;</span>) <span class="stringliteral">&#39;N_repeat              =&#39;</span>, N_repeat
<a name="l00391"></a>00391   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i40)&#39;</span>) <span class="stringliteral">&#39;L                     =&#39;</span>, L
<a name="l00392"></a>00392   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i40)&#39;</span>) <span class="stringliteral">&#39;spin                  =&#39;</span>, spin
<a name="l00393"></a>00393   <span class="keyword">write</span>(*,*)
<a name="l00394"></a>00394 
<a name="l00395"></a>00395   <span class="keyword">if</span> (spin == 0) <span class="keyword">then</span>
<a name="l00396"></a>00396      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;DH real&#39;</span>
<a name="l00397"></a>00397      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average forward transform time =&#39;</span>, &amp;
<a name="l00398"></a>00398           sum(durations_forward_dh_real(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00399"></a>00399      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average inverse transform time =&#39;</span>, &amp;
<a name="l00400"></a>00400           sum(durations_inverse_dh_real(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00401"></a>00401      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e30.5)&#39;</span>) <span class="stringliteral">&#39; Average max error              =&#39;</span>, &amp;
<a name="l00402"></a>00402           sum(errors_dh_real(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00403"></a>00403      <span class="keyword">write</span>(*,*)
<a name="l00404"></a>00404 
<a name="l00405"></a>00405      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;GL real&#39;</span>
<a name="l00406"></a>00406      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average forward transform time =&#39;</span>, &amp;
<a name="l00407"></a>00407           sum(durations_forward_gl_real(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00408"></a>00408      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average inverse transform time =&#39;</span>, &amp;
<a name="l00409"></a>00409           sum(durations_inverse_gl_real(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00410"></a>00410      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e30.5)&#39;</span>) <span class="stringliteral">&#39; Average max error              =&#39;</span>, &amp;
<a name="l00411"></a>00411           sum(errors_gl_real(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00412"></a>00412      <span class="keyword">write</span>(*,*)
<a name="l00413"></a>00413 
<a name="l00414"></a>00414      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;MWEO real&#39;</span>
<a name="l00415"></a>00415      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average forward transform time =&#39;</span>, &amp;
<a name="l00416"></a>00416           sum(durations_forward_mweo_real(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00417"></a>00417      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average inverse transform time =&#39;</span>, &amp;
<a name="l00418"></a>00418           sum(durations_inverse_mweo_real(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00419"></a>00419      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e30.5)&#39;</span>) <span class="stringliteral">&#39; Average max error              =&#39;</span>, &amp;
<a name="l00420"></a>00420           sum(errors_mweo_real(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00421"></a>00421      <span class="keyword">write</span>(*,*)
<a name="l00422"></a>00422 
<a name="l00423"></a>00423      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;MW real&#39;</span>
<a name="l00424"></a>00424      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average forward transform time =&#39;</span>, &amp;
<a name="l00425"></a>00425           sum(durations_forward_mw_real(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00426"></a>00426      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average inverse transform time =&#39;</span>, &amp;
<a name="l00427"></a>00427           sum(durations_inverse_mw_real(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00428"></a>00428      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e30.5)&#39;</span>) <span class="stringliteral">&#39; Average max error              =&#39;</span>, &amp;
<a name="l00429"></a>00429           sum(errors_mw_real(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00430"></a>00430      <span class="keyword">write</span>(*,*)
<a name="l00431"></a>00431   <span class="keyword">end if</span>
<a name="l00432"></a>00432 
<a name="l00433"></a>00433   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;DH&#39;</span>
<a name="l00434"></a>00434   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average forward transform time =&#39;</span>, &amp;
<a name="l00435"></a>00435        sum(durations_forward_dh(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00436"></a>00436   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average inverse transform time =&#39;</span>, &amp;
<a name="l00437"></a>00437        sum(durations_inverse_dh(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00438"></a>00438   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e30.5)&#39;</span>) <span class="stringliteral">&#39; Average max error              =&#39;</span>, &amp;
<a name="l00439"></a>00439        sum(errors_dh(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00440"></a>00440   <span class="keyword">write</span>(*,*)
<a name="l00441"></a>00441 
<a name="l00442"></a>00442   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;GL&#39;</span>
<a name="l00443"></a>00443   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average forward transform time =&#39;</span>, &amp;
<a name="l00444"></a>00444        sum(durations_forward_gl(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00445"></a>00445   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average inverse transform time =&#39;</span>, &amp;
<a name="l00446"></a>00446        sum(durations_inverse_gl(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00447"></a>00447   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e30.5)&#39;</span>) <span class="stringliteral">&#39; Average max error              =&#39;</span>, &amp;
<a name="l00448"></a>00448        sum(errors_gl(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00449"></a>00449   <span class="keyword">write</span>(*,*)
<a name="l00450"></a>00450 
<a name="l00451"></a>00451   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;MWEO&#39;</span>
<a name="l00452"></a>00452   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average forward transform time =&#39;</span>, &amp;
<a name="l00453"></a>00453        sum(durations_forward_mweo(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00454"></a>00454   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average inverse transform time =&#39;</span>, &amp;
<a name="l00455"></a>00455        sum(durations_inverse_mweo(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00456"></a>00456   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e30.5)&#39;</span>) <span class="stringliteral">&#39; Average max error              =&#39;</span>, &amp;
<a name="l00457"></a>00457        sum(errors_mweo(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00458"></a>00458   <span class="keyword">write</span>(*,*)
<a name="l00459"></a>00459 
<a name="l00460"></a>00460   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,i2)&#39;</span>) <span class="stringliteral">&#39;MW&#39;</span>
<a name="l00461"></a>00461   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average forward transform time =&#39;</span>, &amp;
<a name="l00462"></a>00462        sum(durations_forward_mw(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00463"></a>00463   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,f30.5)&#39;</span>) <span class="stringliteral">&#39; Average inverse transform time =&#39;</span>, &amp;
<a name="l00464"></a>00464        sum(durations_inverse_mw(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00465"></a>00465   <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a,e30.5)&#39;</span>) <span class="stringliteral">&#39; Average max error              =&#39;</span>, &amp;
<a name="l00466"></a>00466        sum(errors_mw(0:N_repeat-1)) / <span class="keywordtype">real</span>(N_repeat)
<a name="l00467"></a>00467   <span class="keyword">write</span>(*,*)
<a name="l00468"></a>00468 
<a name="l00469"></a>00469   <span class="comment">! Deallocate memory.</span>
<a name="l00470"></a>00470   <span class="keyword">deallocate</span>(flm_orig, flm_syn)
<a name="l00471"></a>00471   <span class="keyword">deallocate</span>(f_dh, f_gl, f_mweo, f_mw)
<a name="l00472"></a>00472   <span class="keyword">deallocate</span>(f_dh_real, f_gl_real, f_mweo_real, f_mw_real)
<a name="l00473"></a>00473 
<a name="l00474"></a>00474 <span class="keyword">end program ssht_test</span>
<a name="l00475"></a>00475 
<a name="l00476"></a>00476 
<a name="l00477"></a>00477 <span class="comment">!--------------------------------------------------------------------------</span>
<a name="l00478"></a>00478 <span class="comment">! ssht_test_gen_flm_real</span>
<a name="l00479"></a>00479 <span class="comment">!</span>
<a name="l00480"></a>00480 <span class="comment">!! Generate random spherical harmonic coefficients of a real spin=0</span>
<a name="l00481"></a>00481 <span class="comment">!! signal.</span>
<a name="l00482"></a>00482 <span class="comment">!!</span>
<a name="l00483"></a>00483 <span class="comment">!! Variables:</span>
<a name="l00484"></a>00484 <span class="comment">!!   - L: Harmonic band-limit [input].</span>
<a name="l00485"></a>00485 <span class="comment">!!   - flm(0:L**2-1): Random spherical harmonic coefficients generated </span>
<a name="l00486"></a>00486 <span class="comment">!!     [output].</span>
<a name="l00487"></a>00487 <span class="comment">!!   - seed: Integer seed required for random number generator [input].</span>
<a name="l00488"></a>00488 <span class="comment">!</span>
<a name="l00489"></a>00489 <span class="comment">!! @author J. D. McEwen</span>
<a name="l00490"></a>00490 <span class="comment">!! @version 0.1 October 2010</span>
<a name="l00491"></a>00491 <span class="comment">! </span>
<a name="l00492"></a>00492 <span class="comment">! Revisions:</span>
<a name="l00493"></a>00493 <span class="comment">!   October 2010 - Jason McEwen</span>
<a name="l00494"></a>00494 <span class="comment">!--------------------------------------------------------------------------</span>
<a name="l00495"></a>00495 
<a name="l00496"></a><a class="code" href="ssht__test_8f90.html#a38f7ebbfee8c28f88b922ca179618a98">00496</a> <span class="keyword">subroutine </span><a class="code" href="ssht__test_8f90.html#a38f7ebbfee8c28f88b922ca179618a98">ssht_test_gen_flm_real</a>(L, flm, seed)
<a name="l00497"></a>00497 
<a name="l00498"></a>00498   use <span class="keywordflow">ssht_types_mod</span>, only: dpc
<a name="l00499"></a>00499   use <span class="keywordflow">ssht_sampling_mod</span>
<a name="l00500"></a>00500 
<a name="l00501"></a>00501   <span class="keyword">implicit none</span>
<a name="l00502"></a>00502 
<a name="l00503"></a><a class="code" href="interfacessht__test__gen__flm__real____interface.html">00503</a>   <span class="keyword">interface</span> 
<a name="l00504"></a><a class="code" href="interfacessht__test__gen__flm__real____interface.html#a756ae5d232ead404e0d765d08f0c9552">00504</a>      <span class="keyword">function </span><a class="code" href="ssht__test_8f90.html#a416afc440685d23877041f1b7632745a">ran2_dp</a>(idum)
<a name="l00505"></a>00505        use <span class="keywordflow">ssht_types_mod</span>, only: dp
<a name="l00506"></a>00506        <span class="keywordtype">real(dp) </span>:: ran2_dp
<a name="l00507"></a>00507        <span class="keywordtype">integer</span> :: idum
<a name="l00508"></a>00508 <span class="keyword">     end function ran2_dp</span>
<a name="l00509"></a>00509 <span class="keyword">  end interface</span>
<a name="l00510"></a>00510 
<a name="l00511"></a>00511   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: L
<a name="l00512"></a>00512   <span class="keywordtype">complex(dpc)</span>, <span class="keywordtype">intent(out)</span> :: flm(0:L**2-1)
<a name="l00513"></a>00513   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: seed
<a name="l00514"></a>00514 
<a name="l00515"></a>00515   <span class="keywordtype">integer</span> :: el, m, ind
<a name="l00516"></a>00516   <span class="keywordtype">complex(dpc) </span>:: tmp
<a name="l00517"></a>00517 
<a name="l00518"></a>00518   flm(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00519"></a>00519   <span class="keyword">do</span> el = 0,L-1
<a name="l00520"></a>00520      m = 0
<a name="l00521"></a>00521      call <a class="code" href="namespacessht__sampling__mod.html#a6783e48e387b35bb4a2dc9d5bf575f34">ssht_sampling_elm2ind</a>(ind, el, m)  
<a name="l00522"></a>00522      tmp = cmplx(2d0*<a class="code" href="ssht__test_8f90.html#a416afc440685d23877041f1b7632745a">ran2_dp</a>(seed)-1d0, 0d0)
<a name="l00523"></a>00523      flm(ind) = tmp
<a name="l00524"></a>00524 
<a name="l00525"></a>00525      <span class="keyword">do</span> m = 1,el
<a name="l00526"></a>00526         call <a class="code" href="namespacessht__sampling__mod.html#a6783e48e387b35bb4a2dc9d5bf575f34">ssht_sampling_elm2ind</a>(ind, el, m)  
<a name="l00527"></a>00527         tmp = cmplx(2d0*<a class="code" href="ssht__test_8f90.html#a416afc440685d23877041f1b7632745a">ran2_dp</a>(seed)-1d0, 2d0*<a class="code" href="ssht__test_8f90.html#a416afc440685d23877041f1b7632745a">ran2_dp</a>(seed)-1d0)
<a name="l00528"></a>00528         flm(ind) = tmp
<a name="l00529"></a>00529         call <a class="code" href="namespacessht__sampling__mod.html#a6783e48e387b35bb4a2dc9d5bf575f34">ssht_sampling_elm2ind</a>(ind, el, -m)  
<a name="l00530"></a>00530         flm(ind) = (-1)**m * conjg(tmp)
<a name="l00531"></a>00531      <span class="keyword">end do</span>
<a name="l00532"></a>00532 
<a name="l00533"></a>00533   <span class="keyword">end do</span>
<a name="l00534"></a>00534 
<a name="l00535"></a>00535 <span class="keyword">end subroutine ssht_test_gen_flm_real</span>
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 
<a name="l00538"></a>00538 <span class="comment">!--------------------------------------------------------------------------</span>
<a name="l00539"></a>00539 <span class="comment">! ssht_test_gen_flm_complex</span>
<a name="l00540"></a>00540 <span class="comment">!</span>
<a name="l00541"></a>00541 <span class="comment">!! Generate random spherical harmonic coefficients of a complex signal.</span>
<a name="l00542"></a>00542 <span class="comment">!!</span>
<a name="l00543"></a>00543 <span class="comment">!! Variables:</span>
<a name="l00544"></a>00544 <span class="comment">!!   - L: Harmonic band-limit [input].</span>
<a name="l00545"></a>00545 <span class="comment">!!   - spin: Spin number [input].</span>
<a name="l00546"></a>00546 <span class="comment">!!   - flm(0:L**2-1): Random spherical harmonic coefficients generated </span>
<a name="l00547"></a>00547 <span class="comment">!!     [output].</span>
<a name="l00548"></a>00548 <span class="comment">!!   - seed: Integer seed required for random number generator [input].</span>
<a name="l00549"></a>00549 <span class="comment">!</span>
<a name="l00550"></a>00550 <span class="comment">!! @author J. D. McEwen</span>
<a name="l00551"></a>00551 <span class="comment">!! @version 0.1 October 2010</span>
<a name="l00552"></a>00552 <span class="comment">! </span>
<a name="l00553"></a>00553 <span class="comment">! Revisions:</span>
<a name="l00554"></a>00554 <span class="comment">!   October 2010 - Jason McEwen</span>
<a name="l00555"></a>00555 <span class="comment">!--------------------------------------------------------------------------</span>
<a name="l00556"></a>00556 
<a name="l00557"></a><a class="code" href="ssht__test_8f90.html#a7a26f08f722eb32bf1e26e298f083fac">00557</a> <span class="keyword">subroutine </span><a class="code" href="ssht__test_8f90.html#a7a26f08f722eb32bf1e26e298f083fac">ssht_test_gen_flm_complex</a>(L, spin, flm, seed)
<a name="l00558"></a>00558 
<a name="l00559"></a>00559   use <span class="keywordflow">ssht_types_mod</span>, only: dpc
<a name="l00560"></a>00560   use <span class="keywordflow">ssht_sampling_mod</span>
<a name="l00561"></a>00561 
<a name="l00562"></a>00562   <span class="keyword">implicit none</span>
<a name="l00563"></a>00563 
<a name="l00564"></a><a class="code" href="interfacessht__test__gen__flm__complex____interface.html">00564</a>   <span class="keyword">interface</span> 
<a name="l00565"></a><a class="code" href="interfacessht__test__gen__flm__complex____interface.html#a9face5fe238d3cb7ddf118dad51ba7f5">00565</a>      <span class="keyword">function </span><a class="code" href="ssht__test_8f90.html#a416afc440685d23877041f1b7632745a">ran2_dp</a>(idum)
<a name="l00566"></a>00566        use <span class="keywordflow">ssht_types_mod</span>, only: dp
<a name="l00567"></a>00567        <span class="keywordtype">real(dp) </span>:: ran2_dp
<a name="l00568"></a>00568        <span class="keywordtype">integer</span> :: idum
<a name="l00569"></a>00569 <span class="keyword">     end function ran2_dp</span>
<a name="l00570"></a>00570 <span class="keyword">  end interface</span>
<a name="l00571"></a>00571 
<a name="l00572"></a>00572   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: L
<a name="l00573"></a>00573   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: spin
<a name="l00574"></a>00574   <span class="keywordtype">complex(dpc)</span>, <span class="keywordtype">intent(out)</span> :: flm(0:L**2-1)
<a name="l00575"></a>00575   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: seed
<a name="l00576"></a>00576 
<a name="l00577"></a>00577   <span class="keywordtype">integer</span> :: ind, ind_lo, el, m
<a name="l00578"></a>00578 
<a name="l00579"></a>00579   flm(0:L**2-1) = cmplx(0d0, 0d0)
<a name="l00580"></a>00580 
<a name="l00581"></a>00581   call <a class="code" href="namespacessht__sampling__mod.html#a6783e48e387b35bb4a2dc9d5bf575f34">ssht_sampling_elm2ind</a>(ind_lo, abs(spin), 0)
<a name="l00582"></a>00582   <span class="keyword">do</span> ind = ind_lo,L**2 - 1
<a name="l00583"></a>00583 <span class="comment">!     call ssht_core_ind2elm(el, m, ind)  </span>
<a name="l00584"></a>00584 <span class="comment">!     if(el &gt;= abs(spin)) then</span>
<a name="l00585"></a>00585         flm(ind) = cmplx(2d0*<a class="code" href="ssht__test_8f90.html#a416afc440685d23877041f1b7632745a">ran2_dp</a>(seed)-1d0, 2d0*<a class="code" href="ssht__test_8f90.html#a416afc440685d23877041f1b7632745a">ran2_dp</a>(seed)-1d0)
<a name="l00586"></a>00586 <span class="comment">!     end if</span>
<a name="l00587"></a>00587   <span class="keyword">end do</span>
<a name="l00588"></a>00588 
<a name="l00589"></a>00589 <span class="keyword">end subroutine ssht_test_gen_flm_complex</span>
<a name="l00590"></a>00590 
<a name="l00591"></a>00591 
<a name="l00592"></a>00592 <span class="comment">!--------------------------------------------------------------------------</span>
<a name="l00593"></a>00593 <span class="comment">! ran2_dp</span>
<a name="l00594"></a>00594 <span class="comment">!</span>
<a name="l00595"></a>00595 <span class="comment">!! Generate uniform deviate in range [0,1) given seed.</span>
<a name="l00596"></a>00596 <span class="comment">!! (Using double precision.)</span>
<a name="l00597"></a>00597 <span class="comment">!!</span>
<a name="l00598"></a>00598 <span class="comment">!! Notes: </span>
<a name="l00599"></a>00599 <span class="comment">!!   - Uniform deviate (Num rec 1992, chap 7.1), original routine</span>
<a name="l00600"></a>00600 <span class="comment">!!     said to be &#39;perfect&#39;.</span>
<a name="l00601"></a>00601 <span class="comment">!!</span>
<a name="l00602"></a>00602 <span class="comment">!! Variables:</span>
<a name="l00603"></a>00603 <span class="comment">!!   - idum: Seed.</span>
<a name="l00604"></a>00604 <span class="comment">!</span>
<a name="l00605"></a>00605 <span class="comment">!! @author J. D. McEwen</span>
<a name="l00606"></a>00606 <span class="comment">!! @version 0.1 May 2007</span>
<a name="l00607"></a>00607 <span class="comment">! </span>
<a name="l00608"></a>00608 <span class="comment">! Revisions:</span>
<a name="l00609"></a>00609 <span class="comment">!   May 2007 - Integrated by Jason McEwen</span>
<a name="l00610"></a>00610 <span class="comment">!--------------------------------------------------------------------------</span>
<a name="l00611"></a>00611 
<a name="l00612"></a><a class="code" href="ssht__test_8f90.html#a416afc440685d23877041f1b7632745a">00612</a> <span class="keyword">function </span><a class="code" href="ssht__test_8f90.html#a416afc440685d23877041f1b7632745a">ran2_dp</a>(idum)
<a name="l00613"></a>00613 
<a name="l00614"></a>00614   use <span class="keywordflow">ssht_types_mod</span>, only: dp
<a name="l00615"></a>00615 
<a name="l00616"></a>00616   <span class="keyword">implicit none</span>
<a name="l00617"></a>00617 
<a name="l00618"></a>00618   <span class="keywordtype">INTEGER</span> :: idum,IM1,IM2,IMM1,IA1,IA2,IQ1,IQ2,IR1,IR2,NTAB,NDIV
<a name="l00619"></a>00619   <span class="keywordtype">REAL(dp) </span>:: ran2_dp,AM,EPS,RNMX
<a name="l00620"></a>00620   PARAMETER (IM1=2147483563,IM2=2147483399,AM=1./IM1,IMM1=IM1-1, &amp;
<a name="l00621"></a>00621        &amp; IA1=40014,IA2=40692,IQ1=53668,IQ2=52774,IR1=12211,IR2=3791, &amp;
<a name="l00622"></a>00622        &amp; NTAB=32,NDIV=1+IMM1/NTAB,EPS=1.2e-7,RNMX=1.-EPS)
<a name="l00623"></a>00623   <span class="keywordtype">INTEGER</span> :: idum2,j,k,iv(NTAB),iy
<a name="l00624"></a>00624   <span class="keywordtype">SAVE</span> iv,iy,idum2
<a name="l00625"></a>00625   <span class="keyword">DATA</span> idum2/123456789/, iv/NTAB*0/, iy/0/
<a name="l00626"></a>00626   <span class="keyword">if</span> (idum.le.0) <span class="keyword">then</span>
<a name="l00627"></a>00627      idum=max(-idum,1)
<a name="l00628"></a>00628      idum2=idum
<a name="l00629"></a>00629      <span class="keyword">do</span> j=NTAB+8,1,-1
<a name="l00630"></a>00630         k=idum/IQ1
<a name="l00631"></a>00631         idum=IA1*(idum-k*IQ1)-k*IR1
<a name="l00632"></a>00632         <span class="keyword">if</span> (idum.lt.0) idum=idum+IM1
<a name="l00633"></a>00633         <span class="keyword">if</span> (j.le.NTAB) iv(j)=idum
<a name="l00634"></a>00634      <span class="keyword">end do</span>
<a name="l00635"></a>00635      iy=iv(1)
<a name="l00636"></a>00636   <span class="keyword">end if</span>
<a name="l00637"></a>00637   k=idum/IQ1
<a name="l00638"></a>00638   idum=IA1*(idum-k*IQ1)-k*IR1
<a name="l00639"></a>00639   <span class="keyword">if</span> (idum.lt.0) idum=idum+IM1
<a name="l00640"></a>00640   k=idum2/IQ2
<a name="l00641"></a>00641   idum2=IA2*(idum2-k*IQ2)-k*IR2
<a name="l00642"></a>00642   <span class="keyword">if</span> (idum2.lt.0) idum2=idum2+IM2
<a name="l00643"></a>00643   j=1+iy/NDIV
<a name="l00644"></a>00644   iy=iv(j)-idum2
<a name="l00645"></a>00645   iv(j)=idum
<a name="l00646"></a>00646   <span class="keyword">if</span>(iy.lt.1)iy=iy+IMM1
<a name="l00647"></a>00647   ran2_dp=min(AM*iy,RNMX)
<a name="l00648"></a>00648   return
<a name="l00649"></a>00649 
<a name="l00650"></a>00650 <span class="keyword">end function ran2_dp</span>
<a name="l00651"></a>00651 
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Mon Oct 31 01:20:05 2011 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
